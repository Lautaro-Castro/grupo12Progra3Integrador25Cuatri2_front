<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peli2Ya</title>
    <link rel="stylesheet" href="css/style.css">
    
</head>

<body>
    <header>
        <nav>
            <ul>
                <li><a class="activo">Pel√≠culas</a></li>
                <li><a href="preventa.html">Pre venta</a></li>
                <li><a href="candy.html">Candy</a></li>
                <li><a href="standby.html">Salir</a></li>
            </ul>
         </nav>
    </header>
    <main>
        <h1>Peliculas en cartelera</h1>
        <section id="contenedor-cartelera"></section>
    </main>
    <script>
        let contenedorCartelera = document.getElementById("contenedor-cartelera");
        let contenedorAEstrenar = document.getElementById("contenedor-a-estrenar");
        //Se crea la url para consumir la api
        let url = "http://localhost:3000";

        //Funcion para poder consumir la api y traer las peliculas en cartelera y proximos estrenos
        async function obtenerPeliculasCartelera() {
            try {
                let response = await fetch(`${url}/peliculas`);
                console.log(response);
                console.log(`Solicitud fetch `)
            
                let data = await response.json();
                console.log(data);

                let peliculasCartelera = data.payload;
                console.log(peliculasCartelera);
            

                mostrarPeliculasCartelera(peliculasCartelera);
            
            } catch (error) {
                console.error("Error obteniendo peliculas: ", error);
            }
        }

        //Funcion para poder mostrar en pantalla las peliculas que trajimos de la BD
        function mostrarPeliculasCartelera(array){
            let htmlEnCartelera = "";
            array.forEach(peli => {
                //Se crean los div con las peliculas a mostrar y el <a> con href a la pantalla de compra, pasando el id como parametro con el ?
                htmlEnCartelera += `
                         <div class="card-pelicula">
                            <a class="pelicula-img" href="comprar-entrada.html?id=${peli.id}">
                            <img class="pelicula-img" src="${peli.poster_url}" alt="${peli.nombre}">
                            <h3>${peli.nombre}</h3>
                            </a>
                        </div>
                `;
            });
        
            contenedorCartelera.innerHTML = htmlEnCartelera;
        }

        obtenerPeliculasCartelera();
    </script>
</body>
</html>